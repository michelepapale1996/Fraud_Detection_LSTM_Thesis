Preparing training and test sets...
Creating samples using as look_back = 400
Traceback (most recent call last):
  File "/Applications/PyCharm.app/Contents/helpers/pydev/pydev_run_in_console.py", line 52, in run_file
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/Applications/PyCharm.app/Contents/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/Users/michele/Fraud_Detection_LSTM_Thesis/LSTM_classifier.py", line 151, in <module>
    x, y = create_dataset(bonifici, 400)
  File "/Users/michele/Fraud_Detection_LSTM_Thesis/LSTM_classifier.py", line 82, in create_dataset
    sequence_x, sequence_y = get_sequences(transactions, look_back)
  File "/Users/michele/Fraud_Detection_LSTM_Thesis/LSTM_classifier.py", line 54, in get_sequences
    if transactions.iloc[pointer: pointer + 1]["isFraud"].values[0] == 0:
IndexError: index 0 is out of bounds for axis 0 with size 0
PyDev console: starting.

Python 3.6.3 (v3.6.3:2c5fed86e0, Oct  3 2017, 00:32:08) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
                                      Timestamp   Importo  \
indice                                                      
20141220164514490000328898  2014-12-20 16:04:36  0.030500   
20141231154514807000411159  2014-12-31 15:37:02  0.093078   
20141128154605390000701214  2014-11-28 15:17:46  0.012000   
20141128154605405000605392  2014-11-28 15:18:31  0.015036   
20141128154605499000996878  2014-11-28 15:20:10  0.025100   
...                                         ...       ...   
20150204115723134000284801  2015-02-04 11:41:23  0.003527   
20150205115728669000551899  2015-02-05 11:53:54  0.002367   
20150205121222482000946651  2015-02-05 11:57:21  0.010000   
20150121104511549000696094  2015-01-21 09:58:13  0.005598   
20141030124628720000378688  2014-10-30 11:37:38  0.009760   

                                                      UserID  NumConfermaSMS  \
indice                                                                         
20141220164514490000328898  cd028892a4b9b49f84d787cc587022b4               1   
20141231154514807000411159  6dcbac66f4a535145a12b922341c06df               1   
20141128154605390000701214  01b79c6f4c9119ef0c95ce13b4367ee0               1   
20141128154605405000605392  01b79c6f4c9119ef0c95ce13b4367ee0               1   
20141128154605499000996878  01b79c6f4c9119ef0c95ce13b4367ee0               1   
...                                                      ...             ...   
20150204115723134000284801  565cc90a7c23e6937f06b826c9b7ba84               0   
20150205115728669000551899  565cc90a7c23e6937f06b826c9b7ba84               0   
20150205121222482000946651  565cc90a7c23e6937f06b826c9b7ba84               0   
20150121104511549000696094  565cc90a7c23e6937f06b826c9b7ba84               0   
20141030124628720000378688  565cc90a7c23e6937f06b826c9b7ba84               0   

                            isFraud  isItalianSender  isItalianReceiver  
indice                                                                   
20141220164514490000328898        0                1                  1  
20141231154514807000411159        0                1                  1  
20141128154605390000701214        0                1                  1  
20141128154605405000605392        0                1                  1  
20141128154605499000996878        0                1                  1  
...                             ...              ...                ...  
20150204115723134000284801        0                1                  1  
20150205115728669000551899        0                1                  1  
20150205121222482000946651        0                1                  1  
20150121104511549000696094        0                1                  1  
20141030124628720000378688        0                1                  1  

[482909 rows x 7 columns]
                                      Timestamp   Importo  \
indice                                                      
20141220164514490000328898  2014-12-20 16:04:36  0.030500   
20141231154514807000411159  2014-12-31 15:37:02  0.093078   
20141128154605390000701214  2014-11-28 15:17:46  0.012000   
20141128154605405000605392  2014-11-28 15:18:31  0.015036   
20141128154605499000996878  2014-11-28 15:20:10  0.025100   
...                                         ...       ...   
20150204115723134000284801  2015-02-04 11:41:23  0.003527   
20150205115728669000551899  2015-02-05 11:53:54  0.002367   
20150205121222482000946651  2015-02-05 11:57:21  0.010000   
20150121104511549000696094  2015-01-21 09:58:13  0.005598   
20141030124628720000378688  2014-10-30 11:37:38  0.009760   

                                                      UserID  NumConfermaSMS  \
indice                                                                         
20141220164514490000328898  cd028892a4b9b49f84d787cc587022b4               1   
20141231154514807000411159  6dcbac66f4a535145a12b922341c06df               1   
20141128154605390000701214  01b79c6f4c9119ef0c95ce13b4367ee0               1   
20141128154605405000605392  01b79c6f4c9119ef0c95ce13b4367ee0               1   
20141128154605499000996878  01b79c6f4c9119ef0c95ce13b4367ee0               1   
...                                                      ...             ...   
20150204115723134000284801  565cc90a7c23e6937f06b826c9b7ba84               0   
20150205115728669000551899  565cc90a7c23e6937f06b826c9b7ba84               0   
20150205121222482000946651  565cc90a7c23e6937f06b826c9b7ba84               0   
20150121104511549000696094  565cc90a7c23e6937f06b826c9b7ba84               0   
20141030124628720000378688  565cc90a7c23e6937f06b826c9b7ba84               0   

                            isFraud  isItalianSender  isItalianReceiver  
indice                                                                   
20141220164514490000328898        0                1                  1  
20141231154514807000411159        0                1                  1  
20141128154605390000701214        0                1                  1  
20141128154605405000605392        0                1                  1  
20141128154605499000996878        0                1                  1  
...                             ...              ...                ...  
20150204115723134000284801        0                1                  1  
20150205115728669000551899        0                1                  1  
20150205121222482000946651        0                1                  1  
20150121104511549000696094        0                1                  1  
20141030124628720000378688        0                1                  1  

[482321 rows x 7 columns]
                             Importo  NumConfermaSMS  isItalianSender  \
indice                                                                  
20141220164514490000328898  0.030500               1                1   
20141231154514807000411159  0.093078               1                1   
20141128154605390000701214  0.012000               1                1   
20141128154605405000605392  0.015036               1                1   
20141128154605499000996878  0.025100               1                1   
...                              ...             ...              ...   
20150204115723134000284801  0.003527               0                1   
20150205115728669000551899  0.002367               0                1   
20150205121222482000946651  0.010000               0                1   
20150121104511549000696094  0.005598               0                1   
20141030124628720000378688  0.009760               0                1   

                            isItalianReceiver  
indice                                         
20141220164514490000328898                  1  
20141231154514807000411159                  1  
20141128154605390000701214                  1  
20141128154605405000605392                  1  
20141128154605499000996878                  1  
...                                       ...  
20150204115723134000284801                  1  
20150205115728669000551899                  1  
20150205121222482000946651                  1  
20150121104511549000696094                  1  
20141030124628720000378688                  1  

[482321 rows x 4 columns]
Traceback (most recent call last):
  File "/Users/michele/PycharmProjects/varie/venv/lib/python3.6/site-packages/pandas/core/indexes/base.py", line 2897, in get_loc
    return self._engine.get_loc(key)
  File "pandas/_libs/index.pyx", line 107, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 131, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1607, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1614, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '20150121104511549000696094'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/code.py", line 91, in runcode
    exec(code, self.locals)
  File "<input>", line 1, in <module>
  File "/Users/michele/PycharmProjects/varie/venv/lib/python3.6/site-packages/pandas/core/frame.py", line 2980, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/michele/PycharmProjects/varie/venv/lib/python3.6/site-packages/pandas/core/indexes/base.py", line 2899, in get_loc
    return self._engine.get_loc(self._maybe_cast_indexer(key))
  File "pandas/_libs/index.pyx", line 107, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 131, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1607, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1614, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '20150121104511549000696094'
Timestamp                         2015-01-21 09:58:13
Importo                                     0.0055978
UserID               565cc90a7c23e6937f06b826c9b7ba84
NumConfermaSMS                                      0
isFraud                                             0
isItalianSender                                     1
isItalianReceiver                                   1
Name: 20150121104511549000696094, dtype: object
                                      Timestamp   Importo  \
indice                                                      
20150121104511549000696094  2015-01-21 09:58:13  0.005598   
20141030124628720000378688  2014-10-30 11:37:38  0.009760   

                                                      UserID  NumConfermaSMS  \
indice                                                                         
20150121104511549000696094  565cc90a7c23e6937f06b826c9b7ba84               0   
20141030124628720000378688  565cc90a7c23e6937f06b826c9b7ba84               0   

                            isFraud  isItalianSender  isItalianReceiver  
indice                                                                   
20150121104511549000696094        0                1                  1  
20141030124628720000378688        0                1                  1  
                                      Timestamp   Importo  \
indice                                                      
20141220164514490000328898  2014-12-20 16:04:36  0.030500   
20141231154514807000411159  2014-12-31 15:37:02  0.093078   
20141128154605390000701214  2014-11-28 15:17:46  0.012000   
20141128154605405000605392  2014-11-28 15:18:31  0.015036   
20141128154605499000996878  2014-11-28 15:20:10  0.025100   
...                                         ...       ...   
20150204115723134000284801  2015-02-04 11:41:23  0.003527   
20150205115728669000551899  2015-02-05 11:53:54  0.002367   
20150205121222482000946651  2015-02-05 11:57:21  0.010000   
20150121104511549000696094  2015-01-21 09:58:13  0.005598   
20141030124628720000378688  2014-10-30 11:37:38  0.009760   

                                                      UserID  NumConfermaSMS  \
indice                                                                         
20141220164514490000328898  cd028892a4b9b49f84d787cc587022b4               1   
20141231154514807000411159  6dcbac66f4a535145a12b922341c06df               1   
20141128154605390000701214  01b79c6f4c9119ef0c95ce13b4367ee0               1   
20141128154605405000605392  01b79c6f4c9119ef0c95ce13b4367ee0               1   
20141128154605499000996878  01b79c6f4c9119ef0c95ce13b4367ee0               1   
...                                                      ...             ...   
20150204115723134000284801  565cc90a7c23e6937f06b826c9b7ba84               0   
20150205115728669000551899  565cc90a7c23e6937f06b826c9b7ba84               0   
20150205121222482000946651  565cc90a7c23e6937f06b826c9b7ba84               0   
20150121104511549000696094  565cc90a7c23e6937f06b826c9b7ba84               0   
20141030124628720000378688  565cc90a7c23e6937f06b826c9b7ba84               0   

                            isFraud  isItalianSender  isItalianReceiver  
indice                                                                   
20141220164514490000328898        0                1                  1  
20141231154514807000411159        0                1                  1  
20141128154605390000701214        0                1                  1  
20141128154605405000605392        0                1                  1  
20141128154605499000996878        0                1                  1  
...                             ...              ...                ...  
20150204115723134000284801        0                1                  1  
20150205115728669000551899        0                1                  1  
20150205121222482000946651        0                1                  1  
20150121104511549000696094        0                1                  1  
20141030124628720000378688        0                1                  1  

[482909 rows x 7 columns]
