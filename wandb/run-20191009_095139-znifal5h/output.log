Preparing training and test sets
Ci sono 7830 serie con 57267 utenti.
Ci sono 96 serie con 23085 utenti.
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 20, 50)            20200     
_________________________________________________________________
lstm_2 (LSTM)                (None, 50)                20200     
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 51        
=================================================================
Total params: 40,451
Trainable params: 40,451
Non-trainable params: 0
_________________________________________________________________
Training model...
Training
Traceback (most recent call last):
  File "/Applications/PyCharm.app/Contents/helpers/pydev/pydev_run_in_console.py", line 52, in run_file
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/Applications/PyCharm.app/Contents/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/Users/michele/Fraud_Detection_LSTM_Thesis/LSTM_classifier.py", line 99, in <module>
    history = LSTM.train_model(model, x_train, y_train, batch_size, epochs, shuffle, validation, ([], []), patience)
  File "/Users/michele/Fraud_Detection_LSTM_Thesis/models/LSTM.py", line 89, in train_model
    history_callback = model.fit(x_train, y_train, epochs=epochs, verbose=2, callbacks=[WandbCallback()])
  File "/Users/michele/PycharmProjects/varie/venv/lib/python3.6/site-packages/keras/engine/training.py", line 1154, in fit
    batch_size=batch_size)
  File "/Users/michele/PycharmProjects/varie/venv/lib/python3.6/site-packages/keras/engine/training.py", line 579, in _standardize_user_data
    exception_prefix='input')
  File "/Users/michele/PycharmProjects/varie/venv/lib/python3.6/site-packages/keras/engine/training_utils.py", line 145, in standardize_input_data
    str(data_shape))
ValueError: Error when checking input: expected lstm_1_input to have shape (20, 50) but got array with shape (20, 7)
PyDev console: starting.

Python 3.6.3 (v3.6.3:2c5fed86e0, Oct  3 2017, 00:32:08) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
array([[['0.032207806441561286', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.003999800799960161', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ...,
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1']],

       [['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ...,
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1']],

       [['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ...,
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.005999801199960241', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1']],

       ...,

       [['0.01829980365996073', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.02019980403996081', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.02091980418396084', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ...,
        ['0.15249983049996613', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.09149981829996366', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.003659800731960147', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1']],

       [['0.199999839999968', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.4000198800039761', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '0'],
        ['0.0648736129747226', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ...,
        ['0.005070201014040204', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.001920000384000077', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.06782941356588272', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1']],

       [['0.199999839999968', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.09999981999996402', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.00819980163996033', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ...,
        ['0.025359805071961016', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.027819805563961117', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1'],
        ['0.02727980545596109', '0000-00-00 00:00:00',
         '0000-00-00 00:00:00', ..., '0', '1', '1']]], dtype='<U32')
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/code.py", line 91, in runcode
    exec(code, self.locals)
  File "<input>", line 1, in <module>
NameError: name 'shape' is not defined
(7830, 20, 7)
7
